{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Renz-Lunci/Desktop/Rx/%20Technology/Repository/lakaw-socmed-Website/src/app/home/ShareReel.tsx"],"sourcesContent":["\r\n\"use client\";\r\nimport { hideModal } from \"@/app/store/Slice/ModalsSlice\";\r\nimport { useAppDispatch, useAppSelector } from \"@/app/utils/hooks\";\r\nimport useApiPost from \"@/app/hooks/postData\";\r\nimport React, { useEffect, useRef, useState, useCallback } from \"react\";\r\nimport SearchInput from \"../components/SearchInput\";\r\nimport { ClipLoader } from \"react-spinners\";\r\nimport { toast } from \"react-toastify\";\r\nimport { setUserId } from \"@/app/store/Slice/UserIdHashtagIdSlice\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport Image from \"next/image\";\r\nimport { FindUserRes, SendMessageRes, UserRecord } from \"../types/ResTypes\";\r\nimport { setReelSharedTrue } from \"../store/Slice/handleCommentCount\";\r\nimport CustomDialog from \"../components/CustomDialog\";\r\n\r\nfunction ShareReel() {\r\n  const open = useAppSelector((state) => state.modals.ShareReel);\r\n  const dispatch = useAppDispatch();\r\n  const { postData } = useApiPost();\r\n  const router = useRouter();\r\n\r\n  const [users, setUsers] = useState<UserRecord[]>([]);\r\n  const [page, setPage] = useState(1);\r\n  const [totalPages, setTotalPages] = useState(1);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [isLoadingNext, setIsLoadingNext] = useState(false);\r\n  const [searchText, setSearchText] = useState(\"\");\r\n  const [hasMore, setHasMore] = useState(true);\r\n\r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n  const initialLoadDone = useRef(false);\r\n  const observer = useRef<IntersectionObserver | null>(null);\r\n\r\n  // Load Users\r\n  const fetchUsers = async (\r\n    pageNum: number = 1,\r\n    append = false,\r\n    search = \"\"\r\n  ) => {\r\n    if (!hasMore || (append && pageNum > totalPages)) return;\r\n\r\n    if (!append) setIsLoading(true);\r\n    else setIsLoadingNext(true);\r\n\r\n    try {\r\n      const res: FindUserRes = await postData(\"/users/find-user\", {\r\n        page: pageNum,\r\n        user_name: search,\r\n      });\r\n\r\n      if (res?.status) {\r\n        const records = (res.data?.Records || []).filter(\r\n          (user: UserRecord) => user.user_name && user.user_name.trim() !== \"\"\r\n        );\r\n        const pages = res.data?.Pagination?.total_pages || 1;\r\n\r\n        setUsers((prev) => (append ? [...prev, ...records] : records));\r\n        setTotalPages(pages);\r\n        setPage(pageNum);\r\n        setHasMore(pageNum < pages && records.length > 0);\r\n      }\r\n    } catch (err) {\r\n    } finally {\r\n      setIsLoading(false);\r\n      setIsLoadingNext(false);\r\n    }\r\n  };\r\n\r\n  // Initial Fetch on Open\r\n  useEffect(() => {\r\n    const fetchInitialUsers = async () => {\r\n      if (open && !initialLoadDone.current) {\r\n        setUsers([]);\r\n        setPage(1);\r\n        setSearchText(\"\");\r\n        setHasMore(true);\r\n        initialLoadDone.current = true;\r\n\r\n        await fetchUsers(1, false, \"\");\r\n      }\r\n    };\r\n\r\n    fetchInitialUsers();\r\n\r\n    return () => {\r\n      initialLoadDone.current = false;\r\n    };\r\n  }, [open]);\r\n\r\n  // IntersectionObserver for infinite scroll\r\n  const lastUserElementRef = useCallback(\r\n    (node: HTMLDivElement) => {\r\n      if (isLoading || isLoadingNext) return;\r\n\r\n      if (observer.current) observer.current.disconnect();\r\n\r\n      observer.current = new IntersectionObserver(\r\n        (entries) => {\r\n          if (entries[0].isIntersecting && hasMore && page < totalPages) {\r\n            fetchUsers(page + 1, true, searchText);\r\n          }\r\n        },\r\n        { threshold: 0.1 }\r\n      );\r\n\r\n      if (node) observer.current.observe(node);\r\n    },\r\n    [isLoading, isLoadingNext, hasMore, page, totalPages, searchText]\r\n  );\r\n\r\n  // Manual Search\r\n  const handleSearch = async (text: string) => {\r\n    const trimmed = text.trim();\r\n    setSearchText(trimmed);\r\n    setUsers([]);\r\n    setPage(1);\r\n    setHasMore(true);\r\n    await fetchUsers(1, false, trimmed);\r\n  };\r\n\r\n  // Send Reel\r\n  const socialId = useAppSelector((state) => state.selectedReel.ReelId);\r\n  const handleSendReel = async (userId: number) => {\r\n    try {\r\n      const response: SendMessageRes = await postData(\"/chat/send-message\", {\r\n        user_id: userId,\r\n        message_type: \"social\",\r\n        social_id: socialId,\r\n        message_content: \"\",\r\n      });\r\n\r\n      if (response.status) {\r\n        toast.success(\"Reel sent successfully!\");\r\n        dispatch(setReelSharedTrue(socialId));\r\n        dispatch(hideModal(\"ShareReel\"));\r\n      }\r\n    } catch (error) {\r\n      toast.error(\"Failed to send reel\");\r\n    }\r\n  };\r\n\r\n  // Navigate to User Profile\r\n  const handleUserRoute = (userId: number) => {\r\n    dispatch(setUserId(userId));\r\n    dispatch(hideModal(\"ShareReel\"));\r\n    router.push(`/profile/${userId}`);\r\n  };\r\n\r\n  return (\r\n    <CustomDialog open={open} onClose={() => dispatch(hideModal(\"ShareReel\"))} title=\"Share Reel\" width=\"420px\">\r\n      <div className=\"rounded-xl relative\">\r\n        <div className=\"pl-6 pt-4\">\r\n          <SearchInput placeholder=\"Search User\" onSearch={handleSearch} />\r\n        </div>\r\n\r\n        {isLoading ? (\r\n          <div className=\"flex justify-center h-[500px]\">\r\n            <ClipLoader color=\"#1A9D77\" size={20} />\r\n          </div>\r\n        ) : (\r\n          <div\r\n            ref={containerRef}\r\n            className=\"mt-4 h-[500px] overflow-y-auto px-6\"\r\n          >\r\n            {users.length === 0 ? (\r\n              <p className=\"text-sm text-center text-gray-500\">\r\n                No users found.\r\n              </p>\r\n            ) : (\r\n              users.map((account, index) => (\r\n                <div\r\n                  key={account.user_id}\r\n                  ref={index === users.length - 1 ? lastUserElementRef : null}\r\n                  className=\"flex justify-between mb-4 items-center\"\r\n                >\r\n                  <div\r\n                    className=\"flex gap-2 items-center cursor-pointer\"\r\n                    onClick={() => handleUserRoute(account.user_id)}\r\n                  >\r\n                    <div className=\"rounded-full w-[40px] h-[40px] overflow-hidden bg-gray-200\">\r\n                      <Image\r\n                        src={account.profile_pic || \"/default-avatar.png\"}\r\n                        alt={account.user_name}\r\n                        className=\"w-full h-full object-cover\"\r\n                        width={60}\r\n                        height={60}\r\n                      />\r\n                    </div>\r\n                    <div className=\"flex flex-col\">\r\n                      <h3 className=\"text-xs text-dark\">{account.user_name}</h3>\r\n                      <p className=\"text-[10px] text-dark/[0.4]\">\r\n                        {account.full_name}\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                  <button\r\n                    onClick={() => handleSendReel(account.user_id)}\r\n                    className=\"cursor-pointer text-[10px] font-normal rounded-xl w-16 py-1 bg-main-green text-primary\"\r\n                  >\r\n                    Send\r\n                  </button>\r\n                </div>\r\n              ))\r\n            )}\r\n            {isLoadingNext && (\r\n              <div className=\"flex justify-center py-4\">\r\n                <ClipLoader color=\"#1A9D77\" size={15} />\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </CustomDialog>\r\n  );\r\n}\r\n\r\nexport default ShareReel;"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 307, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Renz-Lunci/Desktop/Rx/%20Technology/Repository/lakaw-socmed-Website/src/app/home/Upload/CaptionInput.tsx"],"sourcesContent":["\"use client\";\r\nimport React, { useState, useRef } from \"react\";\r\nimport { useAppSelector, useAppDispatch } from \"../../utils/hooks\";\r\nimport { setCaption } from \"@/app/store/Slice/MediaSlice\";\r\nimport useApiPost from \"@/app/hooks/postData\";\r\nimport { HashtagRecord, HashtagSocialResponse } from \"@/app/types/ResTypes\";\r\n\r\nexport default function CaptionInput() {\r\n  const caption = useAppSelector((state) => state.media.caption);\r\n  const dispatch = useAppDispatch();\r\n  const [showDropdown, setShowDropdown] = useState(false);\r\n  const [searchTerm, setSearchTerm] = useState(\"\");\r\n  const [hashtags, setHashtags] = useState<HashtagRecord[]>([]);\r\n  const inputRef = useRef<HTMLTextAreaElement>(null);\r\n\r\n  const {postData} = useApiPost();\r\n\r\n  // Fetch hashtags from API\r\n  const fetchHashtags = async (query: string) => {\r\n    if (!query) return;\r\n    try {\r\n      const res:HashtagSocialResponse = await postData(\"/hashtag/get-hashtags\", {\r\n        hashtag_name: query \r\n      });\r\n      setHashtags(res.data?.Records || []);\r\n    } catch (err) {\r\n      setHashtags([]);\r\n    }\r\n  };\r\n\r\n  const handleChange = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\r\n    const val = e.target.value;\r\n    dispatch(setCaption(val));\r\n\r\n    // Detect last #word\r\n    const hashMatch = val.match(/#(\\w*)$/);\r\n    if (hashMatch) {\r\n      setSearchTerm(hashMatch[1]);\r\n      setShowDropdown(true);\r\n      fetchHashtags(hashMatch[1]); // fetch from API\r\n    } else {\r\n      setShowDropdown(false);\r\n      setHashtags([]);\r\n    }\r\n  };\r\n\r\n  const handleSelect = (tag: string) => {\r\n    const newText = caption.replace(/#(\\w*)$/, `#${tag} `);\r\n    dispatch(setCaption(newText));\r\n    setShowDropdown(false);\r\n    inputRef.current?.focus();\r\n  };\r\n\r\n  return (\r\n    <div className=\"relative\">\r\n      <label className=\"text-sm text-dark\">Write a Caption</label>\r\n      <textarea\r\n        ref={inputRef}\r\n        rows={5}\r\n        className=\"w-full border border-border-color text-xs rounded-md p-2 bg-primary focus:outline-none focus:ring-1 focus:ring-main-green\"\r\n        placeholder=\"Write a Caption\"\r\n        value={caption}\r\n        onChange={handleChange}\r\n      />\r\n\r\n      {showDropdown && hashtags.length > 0 && (\r\n        <ul className=\"absolute bg-primary border mt-1 rounded-md max-h-48 overflow-auto z-50 w-full\">\r\n          {hashtags.map((tag) => (\r\n            <li\r\n              key={tag.hashtag_id}\r\n              className=\"px-2 py-1 text-xs cursor-pointer hover:bg-green-100 text-main-green\"\r\n              onClick={() => handleSelect(tag.hashtag_name)}\r\n            >\r\n              #{tag.hashtag_name}\r\n            </li>\r\n          ))}\r\n        </ul>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;AAJA;;;;;;AAOe,SAAS;IACtB,MAAM,UAAU,IAAA,4NAAc,EAAC,CAAC,QAAU,MAAM,KAAK,CAAC,OAAO;IAC7D,MAAM,WAAW,IAAA,4NAAc;IAC/B,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,8RAAQ,EAAC;IACjD,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,8RAAQ,EAAC;IAC7C,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,8RAAQ,EAAkB,EAAE;IAC5D,MAAM,WAAW,IAAA,4RAAM,EAAsB;IAE7C,MAAM,EAAC,QAAQ,EAAC,GAAG,IAAA,wNAAU;IAE7B,0BAA0B;IAC1B,MAAM,gBAAgB,OAAO;QAC3B,IAAI,CAAC,OAAO;QACZ,IAAI;YACF,MAAM,MAA4B,MAAM,SAAS,yBAAyB;gBACxE,cAAc;YAChB;YACA,YAAY,IAAI,IAAI,EAAE,WAAW,EAAE;QACrC,EAAE,OAAO,KAAK;YACZ,YAAY,EAAE;QAChB;IACF;IAEA,MAAM,eAAe,CAAC;QACpB,MAAM,MAAM,EAAE,MAAM,CAAC,KAAK;QAC1B,SAAS,IAAA,sOAAU,EAAC;QAEpB,oBAAoB;QACpB,MAAM,YAAY,IAAI,KAAK,CAAC;QAC5B,IAAI,WAAW;YACb,cAAc,SAAS,CAAC,EAAE;YAC1B,gBAAgB;YAChB,cAAc,SAAS,CAAC,EAAE,GAAG,iBAAiB;QAChD,OAAO;YACL,gBAAgB;YAChB,YAAY,EAAE;QAChB;IACF;IAEA,MAAM,eAAe,CAAC;QACpB,MAAM,UAAU,QAAQ,OAAO,CAAC,WAAW,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC;QACrD,SAAS,IAAA,sOAAU,EAAC;QACpB,gBAAgB;QAChB,SAAS,OAAO,EAAE;IACpB;IAEA,qBACE,2TAAC;QAAI,WAAU;;0BACb,2TAAC;gBAAM,WAAU;0BAAoB;;;;;;0BACrC,2TAAC;gBACC,KAAK;gBACL,MAAM;gBACN,WAAU;gBACV,aAAY;gBACZ,OAAO;gBACP,UAAU;;;;;;YAGX,gBAAgB,SAAS,MAAM,GAAG,mBACjC,2TAAC;gBAAG,WAAU;0BACX,SAAS,GAAG,CAAC,CAAC,oBACb,2TAAC;wBAEC,WAAU;wBACV,SAAS,IAAM,aAAa,IAAI,YAAY;;4BAC7C;4BACG,IAAI,YAAY;;uBAJb,IAAI,UAAU;;;;;;;;;;;;;;;;AAWjC","debugId":null}},
    {"offset": {"line": 415, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Renz-Lunci/Desktop/Rx/%20Technology/Repository/lakaw-socmed-Website/src/app/home/Upload/UploadReel.tsx"],"sourcesContent":["\"use client\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { useAppSelector, useAppDispatch } from \"../../utils/hooks\";\r\nimport { hideModal, showModal } from \"../../store/Slice/ModalsSlice\";\r\nimport Image from \"next/image\";\r\nimport { RxCross2 } from \"react-icons/rx\";\r\nimport LocationSearch from \"@/app/components/LocationSearch\";\r\nimport { clearSelectedMusic, clearVideo } from \"@/app/store/Slice/MediaSlice\";\r\nimport CaptionInput from \"./CaptionInput\";\r\nimport generateVideoThumbnail from \"@/app/utils/generateVideoThumbnail\";\r\nimport { ProjectConfigRes, UploadSocialRes } from \"@/app/types/ResTypes\";\r\nimport Cookies from \"js-cookie\";\r\nimport CustomDialog from \"@/app/components/CustomDialog\";\r\nimport useFFmpegVideo from \"@/app/hooks/useFFmpegVideo\";\r\nimport { toast } from \"react-toastify\";\r\n\r\nfunction UploadReel() {\r\n  const open = useAppSelector((state) => state.modals.UploadReel);\r\n  const dispatch = useAppDispatch();\r\n\r\n  const selectedMusic = useAppSelector((state) => state.media.selectedMusic);\r\n  const caption = useAppSelector((state) => state.media.caption);\r\n  const trimmedVideoFile = useAppSelector(\r\n    (state) => state.media.trimmedVideoFile\r\n  );\r\n  const trimmedVideoUrl = useAppSelector(\r\n    (state) => state.media.trimmedVideoUrl\r\n  );\r\n\r\n  const token = Cookies.get(\"Reelboost_auth_token\");\r\n  const [mediaflow, setMediaflow] = useState<\"LOCAL\" | \"S3\" | string>(\"\");\r\n  const [formData, setFormData] = useState({\r\n    caption: \"\",\r\n    music: \"\",\r\n    location: \"\",\r\n    video: \"\",\r\n  });\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  // âœ… only use hook\r\n  const { ready, processVideo } = useFFmpegVideo();\r\n  useEffect(() => {\r\n    if (!token) return;\r\n\r\n    const fetchConfig = async () => {\r\n      try {\r\n        const res = await fetch(\r\n          `${process.env.NEXT_PUBLIC_API_URL}/project_conf`\r\n        );\r\n        const data: ProjectConfigRes = await res.json();\r\n        if (data?.data?.mediaflow) setMediaflow(data.data.mediaflow);\r\n      } catch (error) {\r\n      }\r\n    };\r\n    fetchConfig();\r\n  }, [token]);\r\n\r\n  const handleSubmit = async () => {\r\n    setLoading(true);\r\n    if (!trimmedVideoFile) {\r\n      alert(\"No video available!\");\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    const finalVideoFile = selectedMusic\r\n      ? await processVideo({\r\n          videoFile: trimmedVideoFile,\r\n          musicUrl: selectedMusic.music_url,\r\n        })\r\n      : trimmedVideoFile;\r\n\r\n    if (!finalVideoFile) {\r\n      alert(\"Video processing failed!\");\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    const thumbnail = await generateVideoThumbnail(finalVideoFile);\r\n    const blob = await fetch(thumbnail).then((res) => res.blob());\r\n    const thumbFile = new File([blob], \"thumbnail.png\", { type: \"image/png\" });\r\n\r\n    const formDataToSend = new FormData();\r\n    formDataToSend.append(\"social_type\", \"reel\");\r\n    formDataToSend.append(\"social_desc\", caption || \"\");\r\n    formDataToSend.append(\"location\", formData.location || \"\");\r\n\r\n    if (selectedMusic?.music_id) {\r\n      formDataToSend.append(\"music_id\", String(selectedMusic.music_id));\r\n    }\r\n\r\n    if (mediaflow === \"LOCAL\") {\r\n      formDataToSend.append(\"files\", thumbFile);\r\n      formDataToSend.append(\"files\", finalVideoFile, finalVideoFile.name);\r\n    } else {\r\n      formDataToSend.append(\"file_media_1\", thumbFile);\r\n      formDataToSend.append(\"file_media_2\", finalVideoFile, finalVideoFile.name);\r\n    }\r\n\r\n    try {\r\n      const response = await fetch(\r\n        `${process.env.NEXT_PUBLIC_API_URL}/social/upload-social`,\r\n        {\r\n          method: \"POST\",\r\n          body: formDataToSend,\r\n          headers: { Authorization: `Bearer ${token}` },\r\n        }\r\n      );\r\n      const responseData: UploadSocialRes = await response.json();\r\n      if (responseData.status) toast.success(responseData.message);\r\n\r\n      dispatch(hideModal(\"UploadReel\"));\r\n      dispatch(clearSelectedMusic());\r\n      dispatch(clearVideo());\r\n      window.location.replace(\"/\");\r\n    } catch (error) {\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // keep Redux music in sync\r\n  useEffect(() => {\r\n    if (selectedMusic?.music_title) {\r\n      setFormData((prev) => ({ ...prev, music: selectedMusic.music_title }));\r\n    }\r\n  }, [selectedMusic]);\r\n\r\n  return (\r\n    <CustomDialog\r\n      open={open}\r\n      onClose={() => dispatch(hideModal(\"UploadReel\"))}\r\n      title=\"Upload Reel\"\r\n      maxWidth=\"xs\"\r\n      fullWidth\r\n    >\r\n      <div className=\"px-6 py-2 space-y-3 sm:max-h-[90vh] max-h-[480px] sm:overflow-visible overflow-y-auto\">\r\n        <CaptionInput />\r\n\r\n        {/* Music */}\r\n        <label className=\"text-sm text-dark\">Music</label>\r\n        <div className=\"relative\">\r\n          <div className=\"absolute left-2 top-1/2 transform -translate-y-1/2 p-2 rounded-full flex items-center justify-center background-opacityGradient\">\r\n            <Image src=\"/home/music.png\" alt=\"User\" width={20} height={20} />\r\n          </div>\r\n          <input\r\n            type=\"text\"\r\n            className={`border border-border-color text-xs rounded-lg w-full py-4 my-1 pl-13 placeholder:text-xs placeholder:text-gray focus:outline-none focus:ring-1 focus:ring-main-green ${\r\n              selectedMusic ? \"background-opacityGradient\" : \"bg-primary\"\r\n            }`}\r\n            placeholder=\"Add Music\"\r\n            value={selectedMusic?.music_title || \"\"}\r\n            readOnly\r\n            onClick={() => dispatch(showModal(\"MusicList\"))}\r\n          />\r\n          {selectedMusic && (\r\n            <div\r\n              className=\"absolute right-2 top-1/2 -translate-y-1/2 cursor-pointer\"\r\n              onClick={() => dispatch(clearSelectedMusic())}\r\n            >\r\n              <RxCross2 className=\"text-dark\" />\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Location */}\r\n        <div className=\"flex flex-col gap-0.5\">\r\n          <label className=\"text-dark text-sm\">Location</label>\r\n          <div className=\"relative\">\r\n            <div className=\"absolute left-2 top-1/2 transform -translate-y-1/2 p-2 rounded-full flex items-center justify-center background-opacityGradient\">\r\n              <Image src=\"/home/Location.png\" alt=\"User\" width={20} height={20} />\r\n            </div>\r\n            <LocationSearch\r\n              value={formData.location}\r\n              onChange={(loc) =>\r\n                setFormData((prev) => ({ ...prev, location: loc }))\r\n              }\r\n              placeholder=\"Search Location\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        {/* Preview */}\r\n        {trimmedVideoUrl && (\r\n          <div className=\"mt-4 rounded-lg w-[200px] h-[250px] mx-auto\">\r\n            <video\r\n              src={trimmedVideoUrl}\r\n              autoPlay\r\n              loop\r\n              className=\"w-full h-full object-cover\"\r\n            />\r\n          </div>\r\n        )}\r\n\r\n        <button\r\n          className=\"bg-main-green text-primary w-full text-sm rounded-xl py-2 cursor-pointer\"\r\n          onClick={handleSubmit}\r\n          disabled={!mediaflow}\r\n        >\r\n          {loading ? \"Uploading\" : \"Upload\"}\r\n        </button>\r\n      </div>\r\n    </CustomDialog>\r\n  );\r\n}\r\n\r\nexport default UploadReel;\r\n "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 719, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Renz-Lunci/Desktop/Rx/%20Technology/Repository/lakaw-socmed-Website/src/app/home/LogoutPopup.tsx"],"sourcesContent":["\"use client\";\r\nimport React from \"react\";\r\nimport Cookies from \"js-cookie\";\r\nimport { useAppDispatch, useAppSelector } from \"../utils/hooks\";\r\nimport { hideModal } from \"../store/Slice/ModalsSlice\";\r\nimport CustomDialog from \"../components/CustomDialog\";\r\n\r\nfunction LogoutPopup() {\r\n  const dispatch = useAppDispatch();\r\n  const open = useAppSelector((state) => state.modals.Logout)\r\n\r\n  const handleLogout = () => {\r\n    Cookies.remove(\"Reelboost_auth_token\");\r\n    Cookies.remove(\"Reelboost_user_id\");\r\n    window.location.replace(\"/\");\r\n  };\r\n  return (\r\n  \r\n          <CustomDialog open={open} onClose={() => dispatch(hideModal(\"Logout\"))} width=\"420px\" title=\"Logout\">\r\n        {/* Title */}\r\n        <div className=\"py-4 xl:py-4\">\r\n        {/* <div className=\"place-items-center mb-4\">\r\n          <p className=\" font-semibold text-base text-center font-gilroy_semibold text-dark\">\r\n            Logout\r\n          </p>\r\n        </div> */}\r\n        <p className=\"text-gray text-center text-sm max-w-xs mx-auto\">\r\n          Are you sure you want to Logout\r\n        </p>\r\n        <p className=\"text-center text-gray text-sm\">your Account?</p>\r\n        <div className=\"flex gap-6 mt-6 justify-center\">\r\n          <button\r\n            className=\"px-10 py-2 rounded-xl text-sm border cursor-pointer border-main-green \"\r\n            \r\n            onClick={() => dispatch(hideModal(\"Logout\"))}\r\n          >\r\n            {\" \"}\r\n            Cancel\r\n          </button>\r\n          <button\r\n            className=\"px-12 py-2 text-primary cursor-pointer font-medium text-sm rounded-xl bg-main-green\"\r\n            onClick={handleLogout}\r\n          >\r\n            Logout\r\n          </button>\r\n        </div>\r\n        </div>\r\n        </CustomDialog>\r\n   \r\n  );\r\n}\r\n\r\nexport default LogoutPopup;\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AALA;;;;;;AAOA,SAAS;IACP,MAAM,WAAW,IAAA,4NAAc;IAC/B,MAAM,OAAO,IAAA,4NAAc,EAAC,CAAC,QAAU,MAAM,MAAM,CAAC,MAAM;IAE1D,MAAM,eAAe;QACnB,6OAAO,CAAC,MAAM,CAAC;QACf,6OAAO,CAAC,MAAM,CAAC;QACf,OAAO,QAAQ,CAAC,OAAO,CAAC;IAC1B;IACA,qBAEQ,2TAAC,iOAAY;QAAC,MAAM;QAAM,SAAS,IAAM,SAAS,IAAA,sOAAS,EAAC;QAAY,OAAM;QAAQ,OAAM;kBAE9F,cAAA,2TAAC;YAAI,WAAU;;8BAMf,2TAAC;oBAAE,WAAU;8BAAiD;;;;;;8BAG9D,2TAAC;oBAAE,WAAU;8BAAgC;;;;;;8BAC7C,2TAAC;oBAAI,WAAU;;sCACb,2TAAC;4BACC,WAAU;4BAEV,SAAS,IAAM,SAAS,IAAA,sOAAS,EAAC;;gCAEjC;gCAAI;;;;;;;sCAGP,2TAAC;4BACC,WAAU;4BACV,SAAS;sCACV;;;;;;;;;;;;;;;;;;;;;;;AAQX;uCAEe","debugId":null}},
    {"offset": {"line": 813, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Renz-Lunci/Desktop/Rx/%20Technology/Repository/lakaw-socmed-Website/src/app/home/Upload/MusicList.tsx"],"sourcesContent":["\"use client\";\r\nimport React, { useRef, useEffect, useState, UIEvent } from \"react\";\r\nimport { Dialog, IconButton } from \"@mui/material\";\r\nimport Image from \"next/image\";\r\nimport { useAppDispatch, useAppSelector } from \"../../utils/hooks\";\r\nimport { hideModal, showModal } from \"../../store/Slice/ModalsSlice\";\r\nimport { useInfiniteQuery } from \"@tanstack/react-query\";\r\nimport axios from \"axios\";\r\nimport { MusicListResponse, MusicRecord } from \"../../types/ResTypes\";\r\nimport Cookies from \"js-cookie\";\r\nimport { CiPlay1 } from \"react-icons/ci\";\r\nimport { GoArrowRight } from \"react-icons/go\";\r\nimport { setSelectedMusic } from \"@/app/store/Slice/MediaSlice\";\r\n\r\nasync function fetchMusic({\r\n  pageParam,\r\n}: {\r\n  pageParam: number;\r\n}): Promise<MusicListResponse> {\r\n  const token = Cookies.get(\"Reelboost_auth_token\");\r\n\r\n  const { data } = await axios.post(\r\n    `${process.env.NEXT_PUBLIC_API_URL}/music/get-music`,\r\n    { page: pageParam },\r\n    {\r\n      headers: {\r\n        ...(token ? { Authorization: `Bearer ${token}` } : {}),\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n    }\r\n  );\r\n  return data;\r\n}\r\n\r\nexport default function MusicList() {\r\n  const dispatch = useAppDispatch();\r\n  const open = useAppSelector((state) => state.modals.MusicList);\r\n  const isTrimVideo = useAppSelector((state) => state.modals.TrimVideo);\r\n  const isUploadReel = useAppSelector((state) => state.modals.UploadReel);\r\n\r\n  const scrollContainerRef = useRef<HTMLDivElement | null>(null);\r\n\r\n  // ðŸ‘‡ Redux values\r\n  const selectedMusic = useAppSelector((state) => state.media.selectedMusic);\r\n\r\n  const {\r\n    data,\r\n    fetchNextPage,\r\n    hasNextPage,\r\n    isFetchingNextPage,\r\n    status,\r\n  } = useInfiniteQuery({\r\n    queryKey: [\"musicList\"],\r\n    queryFn: ({ pageParam = 1 }) => fetchMusic({ pageParam }),\r\n    initialPageParam: 1,\r\n   getNextPageParam: (lastPage) => {\r\n  const pagination = lastPage?.data?.Pagination;\r\n\r\n  if (!pagination) return undefined;\r\n\r\n  const { current_page, total_pages } = pagination;\r\n\r\n  return current_page < total_pages ? current_page + 1 : undefined;\r\n},\r\n\r\n  });\r\n  \r\n\r\n  const [isPlaying, setIsPlaying] = useState(false);\r\n  const audioRef = useRef<HTMLAudioElement | null>(null);\r\n\r\n  // Load music on select\r\n  useEffect(() => {\r\n    if (selectedMusic && audioRef.current) {\r\n      audioRef.current.src = selectedMusic.music_url;\r\n      audioRef.current\r\n        .play()\r\n        .then(() => setIsPlaying(true))\r\n        .catch((err) => {\r\n          console.warn(\"Autoplay failed:\", err);\r\n          setIsPlaying(false);\r\n        });\r\n    }\r\n  }, [selectedMusic]);\r\n\r\n  // Handle select\r\n  const handleSelectMusic = (music: MusicRecord) => {\r\n    if (audioRef.current) {\r\n      audioRef.current.pause();\r\n      audioRef.current.src = \"\";\r\n    }\r\n    dispatch(setSelectedMusic(music));\r\n  };\r\n\r\n  // Play/pause toggle\r\n  const togglePlayPause = () => {\r\n    if (!audioRef.current) return;\r\n\r\n    if (isPlaying) {\r\n      audioRef.current.pause();\r\n      audioRef.current.currentTime = 0;\r\n      audioRef.current.src = \"\";\r\n      setIsPlaying(false);\r\n    } else {\r\n      if (selectedMusic) {\r\n        audioRef.current.src = selectedMusic.music_url;\r\n        audioRef.current.play();\r\n        setIsPlaying(true);\r\n      }\r\n    }\r\n  };\r\n\r\n  // âœ… Handle pagination via onScroll\r\n  const handleScroll = (e: UIEvent<HTMLDivElement>) => {\r\n    const { scrollTop, clientHeight, scrollHeight } = e.currentTarget;\r\n    if (scrollHeight - scrollTop <= clientHeight + 50) {\r\n      if (hasNextPage && !isFetchingNextPage) {\r\n        fetchNextPage();\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Dialog\r\n      open={open}\r\n      onClose={() => dispatch(hideModal(\"MusicList\"))}\r\n      fullWidth\r\n      PaperProps={{\r\n        sx: {\r\n          overflow: \"visible\",\r\n          borderRadius: 3,\r\n          maxHeight: \"90vh\",\r\n          width: \"430px\",\r\n          maxWidth: \"100%\",\r\n          position: \"relative\",\r\n        },\r\n      }}\r\n      BackdropProps={{\r\n        sx: { background: \"#000000BD\" },\r\n      }}\r\n    >\r\n      <h2 className=\"text-lg text-primary bg-main-green rounded-t-lg text-center font-medium px-4 py-3\">\r\n        Add Music\r\n      </h2>\r\n      <button\r\n        onClick={() => dispatch(hideModal(\"MusicList\"))}\r\n        className=\"absolute top-1 right-2 text-primary rounded-full p-2 transition cursor-pointer\"\r\n      >\r\n        âœ•\r\n      </button>\r\n\r\n      {status === \"error\" && (\r\n        <p className=\"px-4 min-h-52 flex justify-center items-center\">\r\n          Failed to load music\r\n        </p>\r\n      )}\r\n\r\n      <div\r\n        className={`flex flex-col gap-3 max-h-[65vh] overflow-y-auto px-4 py-2 ${\r\n          selectedMusic ? \"pb-16\" : \"\"\r\n        }`}\r\n        id=\"music-scroll-container\"\r\n        ref={scrollContainerRef}\r\n        onScroll={handleScroll} // âœ… trigger pagination\r\n      >\r\n        {data?.pages.map((page) =>\r\n          (page as MusicListResponse).data?.Records.map((music: MusicRecord) => (\r\n            <div\r\n              key={music.music_id}\r\n              className=\"flex gap-3 items-center cursor-pointer hover:bg-border-gray p-2 rounded-lg\"\r\n              onClick={() => handleSelectMusic(music)}\r\n            >\r\n              <Image\r\n                src={music.music_thumbnail}\r\n                alt={music.music_title}\r\n                width={54}\r\n                height={54}\r\n                className=\"rounded-lg object-cover\"\r\n              />\r\n              <div>\r\n                <p className=\"font-medium text-xs max-w-[270px] line-clamp-2\">\r\n                  {music.music_title}\r\n                </p>\r\n                <p className=\"text-[10px] text-main-green\">\r\n                  {music.music_desc}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          ))\r\n        )}\r\n\r\n        {isFetchingNextPage && (\r\n          <div className=\"h-10 flex justify-center items-center\">\r\n            <div>Loading more...</div>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Mini Player */}\r\n      {selectedMusic && (\r\n        <div className=\"absolute bottom-0 left-0 w-full bg-main-green rounded-tr-4xl px-4 py-2 flex items-center gap-3\">\r\n          <Image\r\n            src={selectedMusic.music_thumbnail}\r\n            alt={selectedMusic.music_title}\r\n            width={55}\r\n            height={55}\r\n            className=\"rounded-lg object-cover\"\r\n          />\r\n          <div className=\"flex-1\">\r\n            <p className=\"text-xs text-primary font-medium line-clamp-2 max-w-[250px]\">\r\n              {selectedMusic.music_title}\r\n            </p>\r\n            <p className=\"text-[10px] text-primary truncate\">\r\n              {selectedMusic.music_desc}\r\n            </p>\r\n          </div>\r\n\r\n          <div className=\"flex gap-2 place-items-center\">\r\n            <IconButton onClick={togglePlayPause}>\r\n              {isPlaying ? (\r\n                <Image\r\n                  src=\"/ReelBoost/pause.png\"\r\n                  alt=\"pause\"\r\n                  width={28}\r\n                  height={28}\r\n                />\r\n              ) : (\r\n                <CiPlay1 size={28} className=\"text-primary\" />\r\n              )}\r\n            </IconButton>\r\n            <audio ref={audioRef} />\r\n            <div\r\n              className=\"rounded-full w-8 h-8 bg-primary flex place-items-center justify-center cursor-pointer\"\r\n              onClick={() => {\r\n                if (isTrimVideo || isUploadReel) {\r\n                  dispatch(hideModal(\"MusicList\"));\r\n                } else {\r\n                  dispatch(showModal(\"UploadReel\"));\r\n                  dispatch(hideModal(\"MusicList\"));\r\n                }\r\n              }}\r\n            >\r\n              <GoArrowRight className=\"text-main-green text-base\" />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </Dialog>\r\n  );\r\n}\r\n  "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1161, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Renz-Lunci/Desktop/Rx/%20Technology/Repository/lakaw-socmed-Website/src/app/home/Upload/UploadVideo.tsx"],"sourcesContent":["\"use client\";\r\nimport CustomDialog from \"@/app/components/CustomDialog\";\r\nimport { setSelectedVideo, setVideoUrl } from \"@/app/store/Slice/MediaSlice\";\r\nimport { hideModal, showModal } from \"@/app/store/Slice/ModalsSlice\";\r\nimport { useAppDispatch, useAppSelector } from \"@/app/utils/hooks\";\r\nimport { DialogContent } from \"@mui/material\";\r\nimport Image from \"next/image\";\r\nimport { useRef } from \"react\";\r\n\r\nfunction UploadVideo() {\r\n  const open = useAppSelector((state) => state.modals.UploadVideo);\r\n  const dispatch = useAppDispatch();\r\n  const fileInputRef = useRef<HTMLInputElement | null>(null);\r\n\r\n  const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = e.target.files?.[0];\r\n    if (file) {\r\n      const selectedVideoUrl = URL.createObjectURL(file);\r\n      dispatch(setVideoUrl(selectedVideoUrl));\r\n      dispatch(setSelectedVideo(file)); // store single file\r\n      dispatch(showModal(\"TrimVideo\"));\r\n      dispatch(hideModal(\"UploadVideo\"));\r\n    }\r\n  };\r\n\r\n  return (\r\n    // <Dialog\r\n    //       open={open}\r\n    //       onClose={() => {\r\n    //         dispatch(hideModal(\"UploadVideo\"));\r\n\r\n    //       }}\r\n    //       fullWidth\r\n    //       maxWidth=\"sm\"\r\n    //       PaperProps={{\r\n    //         sx: {\r\n    //           p: 0,\r\n    //           borderRadius: \"16px\",\r\n    //           minHeight: \"700px\",\r\n    //           width: \"500px\",\r\n    //           maxWidth: \"100%\",\r\n    //           display: \"flex\",\r\n    //           flexDirection: \"column\",\r\n    //         },\r\n    //       }}\r\n    //     >\r\n    <CustomDialog\r\n      open={open}\r\n      onClose={() => dispatch(hideModal(\"UploadVideo\"))}\r\n      title=\"Upload Video\"\r\n      fullWidth={true}\r\n      maxWidth=\"sm\"\r\n      width=\"500px\"\r\n    >\r\n      <DialogContent sx={{ p: 0, height : \"100%\" }}>\r\n        <div className=\"flex flex-col h-auto bg-primary\">\r\n          {/* Content */}\r\n          <div\r\n            className=\"flex-1 flex items-center justify-center cursor-pointer py-4 sm:py-4 px-4\"\r\n            onClick={() => fileInputRef.current?.click()}\r\n          >\r\n            <div className=\"flex flex-col items-center justify-center border-2 border-dashed border-main-green rounded-lg sm:h-[550px] h-[400px] w-full gap-2 px-6 py-6\">\r\n              <Image\r\n                src=\"/signup/gallery.png\"\r\n                alt=\"Upload photo\"\r\n                width={35}\r\n                height={35}\r\n              />\r\n              <div className=\"text-xs text-icon text-center\">\r\n                Browse to Upload Reel\r\n                <br />\r\n                <span className=\"text-gray text-[10px]\">(.mp4 format)</span>\r\n                <input\r\n                  type=\"file\"\r\n                  accept=\"video/*\"\r\n                  className=\"hidden\"\r\n                  onChange={handleFileChange}\r\n                  ref={fileInputRef}\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Footer with Next Button */}\r\n          <div className=\"px-4 pb-4\">\r\n            <button\r\n              className={`w-full text-sm rounded-xl py-3 ${\r\n                fileInputRef\r\n                  ? \"bg-main-green text-primary cursor-pointer\"\r\n                  : \"bg-main-green/70 cursor-not-allowed text-primary\"\r\n              }`}\r\n              onClick={() => fileInputRef.current?.click()}\r\n            >\r\n              Next\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </DialogContent>\r\n    </CustomDialog>\r\n  );\r\n}\r\n\r\nexport default UploadVideo;\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;;;;;;;;;AASA,SAAS;IACP,MAAM,OAAO,IAAA,4NAAc,EAAC,CAAC,QAAU,MAAM,MAAM,CAAC,WAAW;IAC/D,MAAM,WAAW,IAAA,4NAAc;IAC/B,MAAM,eAAe,IAAA,4RAAM,EAA0B;IAErD,MAAM,mBAAmB,CAAC;QACxB,MAAM,OAAO,EAAE,MAAM,CAAC,KAAK,EAAE,CAAC,EAAE;QAChC,IAAI,MAAM;YACR,MAAM,mBAAmB,IAAI,eAAe,CAAC;YAC7C,SAAS,IAAA,uOAAW,EAAC;YACrB,SAAS,IAAA,4OAAgB,EAAC,QAAQ,oBAAoB;YACtD,SAAS,IAAA,sOAAS,EAAC;YACnB,SAAS,IAAA,sOAAS,EAAC;QACrB;IACF;IAEA,OACE,UAAU;IACV,oBAAoB;IACpB,yBAAyB;IACzB,8CAA8C;IAE9C,WAAW;IACX,kBAAkB;IAClB,sBAAsB;IACtB,sBAAsB;IACtB,gBAAgB;IAChB,kBAAkB;IAClB,kCAAkC;IAClC,gCAAgC;IAChC,4BAA4B;IAC5B,8BAA8B;IAC9B,6BAA6B;IAC7B,qCAAqC;IACrC,aAAa;IACb,WAAW;IACX,QAAQ;kBACR,2TAAC,iOAAY;QACX,MAAM;QACN,SAAS,IAAM,SAAS,IAAA,sOAAS,EAAC;QAClC,OAAM;QACN,WAAW;QACX,UAAS;QACT,OAAM;kBAEN,cAAA,2TAAC,oTAAa;YAAC,IAAI;gBAAE,GAAG;gBAAG,QAAS;YAAO;sBACzC,cAAA,2TAAC;gBAAI,WAAU;;kCAEb,2TAAC;wBACC,WAAU;wBACV,SAAS,IAAM,aAAa,OAAO,EAAE;kCAErC,cAAA,2TAAC;4BAAI,WAAU;;8CACb,2TAAC,qNAAK;oCACJ,KAAI;oCACJ,KAAI;oCACJ,OAAO;oCACP,QAAQ;;;;;;8CAEV,2TAAC;oCAAI,WAAU;;wCAAgC;sDAE7C,2TAAC;;;;;sDACD,2TAAC;4CAAK,WAAU;sDAAwB;;;;;;sDACxC,2TAAC;4CACC,MAAK;4CACL,QAAO;4CACP,WAAU;4CACV,UAAU;4CACV,KAAK;;;;;;;;;;;;;;;;;;;;;;;kCAOb,2TAAC;wBAAI,WAAU;kCACb,cAAA,2TAAC;4BACC,WAAW,CAAC,+BAA+B,EACzC,eACI,8CACA,oDACJ;4BACF,SAAS,IAAM,aAAa,OAAO,EAAE;sCACtC;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQb;uCAEe","debugId":null}},
    {"offset": {"line": 1329, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Renz-Lunci/Desktop/Rx/%20Technology/Repository/lakaw-socmed-Website/src/app/home/Upload/VideoTrimmer.tsx"],"sourcesContent":["\"use client\";\r\nimport Image from \"next/image\";\r\nimport React, { useState, useEffect } from \"react\";\r\n\r\ninterface VideoTrimmerProps {\r\n  duration: number;\r\n  start: number;\r\n  end: number;\r\n  onStartChange: (start: number) => void;\r\n  onEndChange: (end: number) => void;\r\n  onDragEnd: () => void;\r\n  videoFile: File | null;\r\n}\r\n\r\nconst VideoTrimmer: React.FC<VideoTrimmerProps> = ({\r\n  duration,\r\n  start,\r\n  end,\r\n  onStartChange,\r\n  onEndChange,\r\n  onDragEnd,\r\n  videoFile,\r\n}) => {\r\n  const [thumbnails, setThumbnails] = useState<string[]>([]);\r\n\r\n  // Generate thumbnails and validate duration\r\n  useEffect(() => {\r\n    if (!videoFile || duration <= 0) return;\r\n\r\n    let url: string | null = null;\r\n    const generateThumbnails = async () => {\r\n      const video = document.createElement(\"video\");\r\n      const canvas = document.createElement(\"canvas\");\r\n      const ctx = canvas.getContext(\"2d\");\r\n      if (!ctx) return;\r\n\r\n      url = URL.createObjectURL(videoFile);\r\n      video.src = url;\r\n      video.muted = true;\r\n\r\n      await new Promise<void>((resolve) => {\r\n        video.onloadedmetadata = () => resolve();\r\n        video.onerror = () => resolve();\r\n      });\r\n\r\n      const thumbnailCount = Math.min(5, Math.ceil(duration)); // Reduced for performance\r\n      const interval = duration / thumbnailCount;\r\n      const newThumbnails: string[] = [];\r\n\r\n      for (let i = 0; i < thumbnailCount; i++) {\r\n        const time = i * interval;\r\n        try {\r\n          await new Promise<void>((resolve, reject) => {\r\n            video.currentTime = time;\r\n            video.onseeked = () => {\r\n              canvas.width = 100;\r\n              canvas.height = 56;\r\n              ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\r\n              const thumbnail = canvas.toDataURL(\"image/jpeg\");\r\n              newThumbnails.push(thumbnail);\r\n              resolve();\r\n            };\r\n            video.onerror = () => reject(new Error(\"Seek failed\"));\r\n          });\r\n        } catch {}\r\n      }\r\n\r\n      setThumbnails(newThumbnails);\r\n    };\r\n\r\n    generateThumbnails();\r\n\r\n    return () => {\r\n      if (url) URL.revokeObjectURL(url);\r\n    };\r\n  }, [videoFile, duration]);\r\n\r\n  const formatTime = (seconds: number) => {\r\n    const min = Math.floor(seconds / 60);\r\n    const sec = Math.floor(seconds % 60);\r\n    return `${min}:${sec < 10 ? \"0\" : \"\"}${sec}`;\r\n  };\r\n\r\n  // Dragging logic with throttling and touch support\r\n  const handleDrag = (e: React.MouseEvent | React.TouchEvent, type: \"start\" | \"end\") => {\r\n    const container = e.currentTarget.parentElement?.parentElement?.getBoundingClientRect();\r\n    if (!container) return;\r\n\r\n    let lastUpdateTime = 0;\r\n    const throttleDelay = 50;\r\n\r\n    const move = (ev: MouseEvent | TouchEvent) => {\r\n      const now = performance.now();\r\n      if (now - lastUpdateTime < throttleDelay) return;\r\n      lastUpdateTime = now;\r\n\r\n      const clientX = \"touches\" in ev ? ev.touches[0].clientX : (ev as MouseEvent).clientX;\r\n      const percent = (clientX - container.left) / container.width;\r\n      const newTime = Math.min(Math.max(percent * duration, 0), duration);\r\n\r\n      if (type === \"start\") {\r\n        onStartChange(Math.min(newTime, end - 1));\r\n      } else {\r\n        onEndChange(Math.max(newTime, start + 1));\r\n      }\r\n    };\r\n\r\n    const stop = () => {\r\n      window.removeEventListener(\"mousemove\", move as EventListener);\r\n      window.removeEventListener(\"touchmove\", move as EventListener);\r\n      window.removeEventListener(\"mouseup\", stop);\r\n      window.removeEventListener(\"touchend\", stop);\r\n      onDragEnd();\r\n    };\r\n\r\n    window.addEventListener(\"mousemove\", move as EventListener);\r\n    window.addEventListener(\"touchmove\", move as EventListener, { passive: false });\r\n    window.addEventListener(\"mouseup\", stop);\r\n    window.addEventListener(\"touchend\", stop);\r\n  };\r\n\r\n  return (\r\n    <div className=\"relative w-full px-10 pb-4\">\r\n      {/* Thumbnail Track */}\r\n      <div className=\"relative h-14 bg-dark/60 rounded-lg gap-1 border border-main-green overflow-hidden flex mt-4\">\r\n        {thumbnails.length > 0 ? (\r\n          thumbnails.map((thumb, index) => (\r\n            <Image\r\n              key={index}\r\n              src={thumb}\r\n              alt={`thumbnail-${index}`}\r\n              width={42}\r\n              height={56}\r\n              className=\"h-full flex-1 object-cover\"\r\n            />\r\n          ))\r\n        ) : (\r\n          <div className=\"h-full flex items-center justify-center text-gray-500 w-full text-xs\">\r\n            Loading thumbnails\r\n          </div>\r\n        )}\r\n\r\n        {/* Overlay for non-selected range before start */}\r\n        <div\r\n          className=\"absolute h-full bg-dark/50\"\r\n          style={{\r\n            left: \"0%\",\r\n            width: `${(start / duration) * 100}%`,\r\n          }}\r\n        />\r\n\r\n        {/* Overlay for non-selected range after end */}\r\n        <div\r\n          className=\"absolute h-full bg-dark/50\"\r\n          style={{\r\n            left: `${(end / duration) * 100}%`,\r\n            width: `${100 - (end / duration) * 100}%`,\r\n          }}\r\n        />\r\n\r\n        {/* Selected Range */}\r\n        <div\r\n          className=\"absolute h-full border-3 border-main-green rounded-lg\"\r\n          style={{\r\n            left: `${(start / duration) * 100}%`,\r\n            width: `${((end - start) / duration) * 100}%`,\r\n          }}\r\n        >\r\n          {/* Drag Handles on Selected Range Ends */}\r\n          <div\r\n            className=\"absolute w-3 h-3 bg-primary rounded-full cursor-ew-resize border border-main-green\"\r\n            style={{\r\n              left: \"0%\",\r\n              transform: \"translateX(-50%)\",\r\n              top: \"50%\",\r\n              marginTop: \"-6px\",\r\n              zIndex: 10,\r\n            }}\r\n            onMouseDown={(e) => handleDrag(e, \"start\")}\r\n            onTouchStart={(e) => handleDrag(e, \"start\")}\r\n          />\r\n          <div\r\n            className=\"absolute w-3 h-3 bg-primary rounded-full cursor-ew-resize border border-main-green\"\r\n            style={{\r\n              right: \"0%\",\r\n              transform: \"translateX(50%)\",\r\n              top: \"50%\",\r\n              marginTop: \"-6px\",\r\n              zIndex: 10,\r\n            }}\r\n            onMouseDown={(e) => handleDrag(e, \"end\")}\r\n            onTouchStart={(e) => handleDrag(e, \"end\")}\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"flex justify-between mt-1 text-primary text-xs\">\r\n        <span>{formatTime(start)}</span>\r\n        <span>{formatTime(end)}</span>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default VideoTrimmer;"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1558, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Renz-Lunci/Desktop/Rx/%20Technology/Repository/lakaw-socmed-Website/src/app/home/Upload/TrimVideo.tsx"],"sourcesContent":["\"use client\";\r\nimport { hideModal, showModal } from \"@/app/store/Slice/ModalsSlice\";\r\nimport { useAppDispatch, useAppSelector } from \"@/app/utils/hooks\";\r\nimport {\r\n  clearSelectedMusic,\r\n  setTrimmedVideo,\r\n} from \"@/app/store/Slice/MediaSlice\";\r\nimport { DialogContent } from \"@mui/material\";\r\nimport React, { useRef, useState, useEffect } from \"react\";\r\nimport Image from \"next/image\";\r\nimport { IoMdClose } from \"react-icons/io\";\r\nimport useFFmpegVideo from \"@/app/hooks/useFFmpegVideo\";\r\nimport VideoTrimmer from \"./VideoTrimmer\";\r\nimport { toast } from \"react-toastify\";\r\nimport CustomDialog from \"@/app/components/CustomDialog\";\r\n\r\nfunction TrimVideo() {\r\n  const open = useAppSelector((state) => state.modals.TrimVideo);\r\n  const dispatch = useAppDispatch();\r\n  const selectedVideos = useAppSelector((state) => state.media.selectedVideos);\r\n  const selectedMusic = useAppSelector((state) => state.media.selectedMusic);\r\n  const videoFile = selectedVideos;\r\n  const videoRefTop = useRef<HTMLVideoElement | null>(null);\r\n\r\n  const [start, setStart] = useState(0);\r\n  const [end, setEnd] = useState(30);\r\n  const [isMuted, setIsMuted] = useState(false);\r\n  const [hasAudio, setHasAudio] = useState(false);\r\n  const [loading, setLoading] = useState(false);\r\n  const [duration, setDuration] = useState(0);\r\n  const [isDragging, setIsDragging] = useState(false);\r\n  const [videoUrl, setVideoUrl] = useState<string | null>(null);\r\n\r\n  // âœ… only from hook\r\n  const { ready, processVideo } = useFFmpegVideo();\r\n\r\n  // preload video + detect audio\r\n  useEffect(() => {\r\n    if (!videoFile) return;\r\n    const url = URL.createObjectURL(videoFile);\r\n    setVideoUrl(url);\r\n\r\n    const tempVideo = document.createElement(\"video\");\r\n    tempVideo.src = url;\r\n    tempVideo.onloadedmetadata = () => {\r\n      setDuration(tempVideo.duration);\r\n      setEnd(Math.min(30, tempVideo.duration));\r\n      if (videoRefTop.current) {\r\n        videoRefTop.current.currentTime = 0;\r\n        videoRefTop.current.play().catch(() => {});\r\n      }\r\n    };\r\n\r\n    const detectAudio = async () => {\r\n      const audioCtx = new (window.AudioContext ||\r\n        (window as any).webkitAudioContext)();\r\n      const reader = new FileReader();\r\n      reader.onload = async (e) => {\r\n        try {\r\n          await audioCtx.decodeAudioData(e.target!.result as ArrayBuffer);\r\n          setHasAudio(true);\r\n        } catch {\r\n          setHasAudio(false);\r\n        }\r\n      };\r\n      reader.readAsArrayBuffer(videoFile);\r\n    };\r\n    detectAudio();\r\n\r\n    return () => {\r\n      URL.revokeObjectURL(url);\r\n      setVideoUrl(null);\r\n    };\r\n  }, [videoFile]);\r\n\r\n  useEffect(() => {\r\n    if (videoRefTop.current && !isDragging) {\r\n      requestAnimationFrame(() => {\r\n        if (videoRefTop.current) {\r\n          videoRefTop.current.currentTime = start;\r\n          videoRefTop.current.play().catch(() => {});\r\n        }\r\n      });\r\n    }\r\n  }, [start, isDragging]);\r\n\r\n  const handleTrim = async () => {\r\n    if (!videoFile || !ready) return;\r\n    if (end - start > 32) {\r\n      toast.error(\"Upload max 30 seconds video only\");\r\n      return;\r\n    }\r\n    setLoading(true);\r\n    try {\r\n      const file = await processVideo({\r\n        videoFile,\r\n        start,\r\n        end,\r\n        mute: isMuted,\r\n        musicUrl: selectedMusic?.music_url,\r\n      });\r\n      if (!file) return;\r\n\r\n      const url = URL.createObjectURL(file);\r\n      dispatch(setTrimmedVideo({ url, file }));\r\n      dispatch(hideModal(\"TrimVideo\"));\r\n      dispatch(showModal(\"UploadReel\"));\r\n    } catch (err) {\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <CustomDialog\r\n      open={open}\r\n      onClose={() => dispatch(hideModal(\"TrimVideo\"))}\r\n      title=\"Trim Video\"\r\n      fullWidth\r\n      width=\"500px\"\r\n    >\r\n      <DialogContent sx={{ p: 0 }} className=\"overflow-hidden rounded-lg h-[500px] sm:h-auto\">\r\n      <div className=\"flex flex-col h-full bg-primary\">\r\n          {/* Video Preview */}\r\n          {videoFile && videoUrl && (\r\n            <div className=\"relative w-full sm:h-[650px] h-[420px] flex items-center justify-center sm:px-10 px-6 py-6 \">\r\n              <video\r\n                ref={videoRefTop}\r\n                src={videoUrl}\r\n                className=\"w-full h-full object-cover rounded-lg\"\r\n                autoPlay={!isDragging}\r\n                loop\r\n                muted={isMuted || !!selectedMusic}\r\n              />\r\n\r\n              <div className=\"flex flex-col absolute top-10 right-12 gap-3\">\r\n                {/* Mute/Unmute */}\r\n                {hasAudio && !selectedMusic && (\r\n                  <button\r\n                    className=\"bg-dark/50 text-primary p-2 rounded-full cursor-pointer\"\r\n                    onClick={() => setIsMuted((prev) => !prev)}\r\n                  >\r\n                    <Image\r\n                      src={isMuted ? \"/home/muted.png\" : \"/home/unmuted.png\"}\r\n                      alt={isMuted ? \"muted\" : \"unmuted\"}\r\n                      height={18}\r\n                      width={18}\r\n                    />\r\n                  </button>\r\n                )}\r\n\r\n                {/* Add Music */}\r\n                <button\r\n                  className=\"bg-dark/50 text-primary p-2 rounded-full cursor-pointer\"\r\n                  onClick={() => dispatch(showModal(\"MusicList\"))}\r\n                >\r\n                  <Image\r\n                    src=\"/ReelBoost/AddMusic.png\"\r\n                    alt=\"addMusic\"\r\n                    width={18}\r\n                    height={18}\r\n                  />\r\n                </button>\r\n              </div>\r\n\r\n              {/* Selected Music */}\r\n              {selectedMusic && (\r\n                <div className=\"absolute bottom-28 flex items-center gap-3 p-2 rounded-lg\">\r\n                  <div className=\"relative\">\r\n                    <Image\r\n                      src={selectedMusic.music_thumbnail}\r\n                      height={50}\r\n                      width={50}\r\n                      alt=\"music\"\r\n                      className=\"rounded-lg\"\r\n                    />\r\n                    <button\r\n                      className=\"absolute -top-2 -right-2 bg-dark/70 text-primary rounded-full p-1\"\r\n                      onClick={() => dispatch(clearSelectedMusic())}\r\n                    >\r\n                      <IoMdClose size={14} />\r\n                    </button>\r\n                  </div>\r\n                  <p className=\"text-primary text-xs\">{selectedMusic.music_title}</p>\r\n                  <audio src={selectedMusic.music_url} autoPlay loop />\r\n                </div>\r\n              )}\r\n\r\n              {/* Video Trimmer */}\r\n              <div className=\"absolute bottom-2 px-4\">\r\n                <VideoTrimmer\r\n                  duration={duration}\r\n                  start={start}\r\n                  end={end}\r\n                  onStartChange={(newStart) => {\r\n                    setStart(newStart);\r\n                    setIsDragging(true);\r\n                  }}\r\n                  onEndChange={(newEnd) => {\r\n                    setEnd(newEnd);\r\n                    setIsDragging(true);\r\n                  }}\r\n                  onDragEnd={() => setIsDragging(false)}\r\n                  videoFile={videoFile}\r\n                />\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Action Button */}\r\n          <div className=\"px-10 pb-4\">\r\n            <button\r\n              className=\"bg-main-green text-primary w-full py-3 rounded-xl text-sm font-medium\"\r\n              onClick={handleTrim}\r\n              disabled={loading}\r\n            >\r\n              {loading ? \"Processing...\" : \"Next\"}\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </DialogContent>\r\n    </CustomDialog>\r\n  );\r\n}\r\n\r\nexport default TrimVideo;\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1886, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Renz-Lunci/Desktop/Rx/%20Technology/Repository/lakaw-socmed-Website/src/app/home/DeleteSocial.tsx"],"sourcesContent":["\"use client\";\r\nimport React from \"react\";\r\nimport { useAppDispatch, useAppSelector } from \"../utils/hooks\";\r\nimport { hideModal } from \"../store/Slice/ModalsSlice\";\r\nimport { DeleteSocialRes } from \"../types/ResTypes\";\r\nimport useApiPost from \"../hooks/postData\";\r\nimport { toast } from \"react-toastify\";\r\nimport { ClipLoader } from \"react-spinners\";\r\nimport { SocialRecord } from \"../types/Reels\";\r\nimport CustomDialog from \"../components/CustomDialog\";\r\n\r\ninterface DeleteSocialProps {\r\n  setReels: React.Dispatch<React.SetStateAction<SocialRecord[]>>;\r\n}\r\n\r\nfunction DeleteSocial({ setReels }: DeleteSocialProps) {\r\n  const dispatch = useAppDispatch();\r\n  const open = useAppSelector((state) => state.modals.DeleteSocial);\r\n  const socialId = useAppSelector((state) => state.comment.activeReelId);\r\n  const { postData, loading } = useApiPost();\r\n\r\n  const handleDeleteSocial = async () => {\r\n    try {\r\n      const response: DeleteSocialRes = await postData(\r\n        \"/social/delete-social\",\r\n        {\r\n          social_id: socialId,\r\n        }\r\n      );\r\n\r\n      if (response.status) {\r\n        toast.success(response.message);\r\n\r\n        // âœ… Immediately remove from Home reels\r\n        setReels((prev) => prev.filter((reel) => reel.social_id !== socialId));\r\n      } else {\r\n        toast.error(response.message)\r\n      }\r\n\r\n      dispatch(hideModal(\"DeleteSocial\"));\r\n    } catch (error) {\r\n      toast.error(\"Failed to delete reel\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    // <Dialog\r\n    //   open={open}\r\n    //   onClose={() => dispatch(hideModal(\"DeleteSocial\"))}\r\n    //   fullWidth\r\n    //   PaperProps={{\r\n    //     sx: {\r\n    //       p: 0,\r\n    //       overflow: \"visible\",\r\n    //       borderRadius: 3,\r\n    //       maxHeight: \"90vh\",\r\n    //       width: \"420px\",\r\n    //       maxWidth: \"100%\",\r\n    //     },\r\n    //   }}\r\n    //   BackdropProps={{\r\n    //     sx: {\r\n    //       background: \"#000000BD\",\r\n    //     },\r\n    //   }}\r\n    // >\r\n      <CustomDialog open={open} onClose={() => dispatch(hideModal(\"DeleteSocial\"))} title=\"Delete Reel\" width=\"420px\" >\r\n      {/* Title */}\r\n      <div className=\" space-y-4 p-4\">\r\n        {/* <div className=\"place-items-center mb-4\">\r\n          <p className=\" font-semibold text-base text-center font-gilroy_semibold text-dark\">\r\n            Delete Reel\r\n          </p>\r\n        </div> */}\r\n        <p className=\"text-dark text-center text-sm max-w-xs mx-auto\">\r\n          Are you sure you want to delete Reel ?\r\n        </p>\r\n        <div className=\"flex gap-6 justify-center mt-8\">\r\n          <button\r\n            className=\"px-10 py-2 rounded-xl text-sm border cursor-pointer border-main-green \"\r\n            onClick={() => dispatch(hideModal(\"DeleteSocial\"))}\r\n          >\r\n            {\" \"}\r\n            Cancel\r\n          </button>\r\n          <button\r\n            className=\"px-12 py-2 text-primary cursor-pointer font-medium text-sm rounded-xl bg-main-green\"\r\n            onClick={handleDeleteSocial}\r\n          >\r\n            {loading ? <ClipLoader color=\"#FFFFFF\" size={10} /> : \"Delete\"}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </CustomDialog>\r\n  );\r\n}\r\n\r\nexport default DeleteSocial;\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAEA;AACA;AACA;AAEA;AATA;;;;;;;;AAeA,SAAS,aAAa,EAAE,QAAQ,EAAqB;IACnD,MAAM,WAAW,IAAA,4NAAc;IAC/B,MAAM,OAAO,IAAA,4NAAc,EAAC,CAAC,QAAU,MAAM,MAAM,CAAC,YAAY;IAChE,MAAM,WAAW,IAAA,4NAAc,EAAC,CAAC,QAAU,MAAM,OAAO,CAAC,YAAY;IACrE,MAAM,EAAE,QAAQ,EAAE,OAAO,EAAE,GAAG,IAAA,wNAAU;IAExC,MAAM,qBAAqB;QACzB,IAAI;YACF,MAAM,WAA4B,MAAM,SACtC,yBACA;gBACE,WAAW;YACb;YAGF,IAAI,SAAS,MAAM,EAAE;gBACnB,yOAAK,CAAC,OAAO,CAAC,SAAS,OAAO;gBAE9B,uCAAuC;gBACvC,SAAS,CAAC,OAAS,KAAK,MAAM,CAAC,CAAC,OAAS,KAAK,SAAS,KAAK;YAC9D,OAAO;gBACL,yOAAK,CAAC,KAAK,CAAC,SAAS,OAAO;YAC9B;YAEA,SAAS,IAAA,sOAAS,EAAC;QACrB,EAAE,OAAO,OAAO;YACd,yOAAK,CAAC,KAAK,CAAC;QACd;IACF;IAEA,OACE,UAAU;IACV,gBAAgB;IAChB,wDAAwD;IACxD,cAAc;IACd,kBAAkB;IAClB,YAAY;IACZ,cAAc;IACd,6BAA6B;IAC7B,yBAAyB;IACzB,2BAA2B;IAC3B,wBAAwB;IACxB,0BAA0B;IAC1B,SAAS;IACT,OAAO;IACP,qBAAqB;IACrB,YAAY;IACZ,iCAAiC;IACjC,SAAS;IACT,OAAO;IACP,IAAI;kBACF,2TAAC,iOAAY;QAAC,MAAM;QAAM,SAAS,IAAM,SAAS,IAAA,sOAAS,EAAC;QAAkB,OAAM;QAAc,OAAM;kBAExG,cAAA,2TAAC;YAAI,WAAU;;8BAMb,2TAAC;oBAAE,WAAU;8BAAiD;;;;;;8BAG9D,2TAAC;oBAAI,WAAU;;sCACb,2TAAC;4BACC,WAAU;4BACV,SAAS,IAAM,SAAS,IAAA,sOAAS,EAAC;;gCAEjC;gCAAI;;;;;;;sCAGP,2TAAC;4BACC,WAAU;4BACV,SAAS;sCAER,wBAAU,2TAAC,0RAAU;gCAAC,OAAM;gCAAU,MAAM;;;;;uCAAS;;;;;;;;;;;;;;;;;;;;;;;AAMlE;uCAEe","debugId":null}},
    {"offset": {"line": 2017, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Renz-Lunci/Desktop/Rx/%20Technology/Repository/lakaw-socmed-Website/src/app/home/Upload/ViewAudio.tsx"],"sourcesContent":["\"use client\";\r\nimport React, { useEffect } from \"react\";\r\nimport { useAppDispatch, useAppSelector } from \"@/app/utils/hooks\";\r\nimport { hideModal } from \"@/app/store/Slice/ModalsSlice\";\r\nimport { setTotalSocials, setReels } from \"@/app/store/Slice/ViewAudioSlice\";\r\nimport useApiPost from \"@/app/hooks/postData\";\r\nimport Image from \"next/image\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport CustomDialog from \"@/app/components/CustomDialog\";\r\n\r\nfunction ViewAudio() {\r\n  const dispatch = useAppDispatch();\r\n  const open = useAppSelector((state) => state.modals.ViewAudio);\r\n  const MusicImage = useAppSelector((state) => state.music.musicImage);\r\n  const MusicName = useAppSelector((state) => state.music.musicName);\r\n  const MusicId = useAppSelector((state) => state.music.musicId);\r\n  const total_socials = useAppSelector((state) => state.music.total_socials);\r\n\r\n  const { postData } = useApiPost();\r\n  const router = useRouter();\r\n\r\n  useEffect(() => {\r\n    let called = false;\r\n\r\n    const fetchTotalAndReels = async () => {\r\n      if (!MusicId || called) return;\r\n      called = true;\r\n      try {\r\n        const payload = { social_type: \"reel\", page: 1, music_id: MusicId };\r\n        const response = await postData(\"/social/get-social\", payload);\r\n        if (response?.status) {\r\n          dispatch(setTotalSocials(response.data.Pagination.total_records));\r\n          dispatch(setReels(response.data.Records));\r\n          // Save pagination info to slice if needed\r\n        }\r\n      } catch (err) {\r\n      }\r\n    };\r\n\r\n    if (open) fetchTotalAndReels();\r\n  }, [MusicId, open, dispatch]);\r\n\r\n  return (\r\n    // <Dialog\r\n    //   open={open}\r\n    //   onClose={() => dispatch(hideModal(\"ViewAudio\"))}\r\n    //   fullWidth\r\n    //   PaperProps={{\r\n    //     sx: {\r\n    //       p: 0,\r\n    //       overflow: \"visible\",\r\n    //       borderRadius: 3,\r\n    //       maxHeight: \"90vh\",\r\n    //       width: \"420px\",\r\n    //       maxWidth: \"100%\",\r\n    //     },\r\n    //   }}\r\n    //   BackdropProps={{\r\n    //     sx: {\r\n    //       background: \"#000000BD\",\r\n    //     },\r\n    //   }}\r\n    // >\r\n    <CustomDialog\r\n      open={open}\r\n      onClose={() => dispatch(hideModal(\"ViewAudio\"))}\r\n      title=\"View Audio\"\r\n      width=\"420px\"\r\n    >\r\n      <div className=\"flex flex-col items-center w-full text-center pb-6\">\r\n        {/* <div className=\"w-full rounded-t-lg bg-main-green py-3\">\r\n          <h2 className=\"text- font-medium\">View Audio</h2>\r\n        </div> */}\r\n\r\n        <div className=\"relative w-24 h-24 rounded-full mt-6 border-4 border-white shadow-md overflow-hidden\">\r\n          <Image\r\n            src={MusicImage || \"\"}\r\n            alt=\"Audio Thumbnail\"\r\n            fill\r\n            className=\"object-cover\"\r\n          />\r\n        </div>\r\n\r\n        <div className=\"mt-3\">\r\n          <p className=\"text-gray text-sm\">Original Audio</p>\r\n          <h3 className=\"text-lg font-medium text-dark\">{MusicName}</h3>\r\n        </div>\r\n\r\n        <div\r\n          className=\"mt-3 cursor-pointer\"\r\n          onClick={() => {\r\n            router.push(\"/music\");\r\n            dispatch(hideModal(\"ViewAudio\"));\r\n          }}\r\n        >\r\n          <span className=\"px-4 py-1 rounded-md text-dark background-opacityGradient text-sm font-medium\">\r\n            {total_socials} Reels\r\n          </span>\r\n        </div>\r\n      </div>\r\n    </CustomDialog>\r\n  );\r\n}\r\n\r\nexport default ViewAudio;\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;;;;;;;;;;AAUA,SAAS;IACP,MAAM,WAAW,IAAA,4NAAc;IAC/B,MAAM,OAAO,IAAA,4NAAc,EAAC,CAAC,QAAU,MAAM,MAAM,CAAC,SAAS;IAC7D,MAAM,aAAa,IAAA,4NAAc,EAAC,CAAC,QAAU,MAAM,KAAK,CAAC,UAAU;IACnE,MAAM,YAAY,IAAA,4NAAc,EAAC,CAAC,QAAU,MAAM,KAAK,CAAC,SAAS;IACjE,MAAM,UAAU,IAAA,4NAAc,EAAC,CAAC,QAAU,MAAM,KAAK,CAAC,OAAO;IAC7D,MAAM,gBAAgB,IAAA,4NAAc,EAAC,CAAC,QAAU,MAAM,KAAK,CAAC,aAAa;IAEzE,MAAM,EAAE,QAAQ,EAAE,GAAG,IAAA,wNAAU;IAC/B,MAAM,SAAS,IAAA,4NAAS;IAExB,IAAA,+RAAS,EAAC;QACR,IAAI,SAAS;QAEb,MAAM,qBAAqB;YACzB,IAAI,CAAC,WAAW,QAAQ;YACxB,SAAS;YACT,IAAI;gBACF,MAAM,UAAU;oBAAE,aAAa;oBAAQ,MAAM;oBAAG,UAAU;gBAAQ;gBAClE,MAAM,WAAW,MAAM,SAAS,sBAAsB;gBACtD,IAAI,UAAU,QAAQ;oBACpB,SAAS,IAAA,+OAAe,EAAC,SAAS,IAAI,CAAC,UAAU,CAAC,aAAa;oBAC/D,SAAS,IAAA,wOAAQ,EAAC,SAAS,IAAI,CAAC,OAAO;gBACvC,0CAA0C;gBAC5C;YACF,EAAE,OAAO,KAAK,CACd;QACF;QAEA,IAAI,MAAM;IACZ,GAAG;QAAC;QAAS;QAAM;KAAS;IAE5B,OACE,UAAU;IACV,gBAAgB;IAChB,qDAAqD;IACrD,cAAc;IACd,kBAAkB;IAClB,YAAY;IACZ,cAAc;IACd,6BAA6B;IAC7B,yBAAyB;IACzB,2BAA2B;IAC3B,wBAAwB;IACxB,0BAA0B;IAC1B,SAAS;IACT,OAAO;IACP,qBAAqB;IACrB,YAAY;IACZ,iCAAiC;IACjC,SAAS;IACT,OAAO;IACP,IAAI;kBACJ,2TAAC,iOAAY;QACX,MAAM;QACN,SAAS,IAAM,SAAS,IAAA,sOAAS,EAAC;QAClC,OAAM;QACN,OAAM;kBAEN,cAAA,2TAAC;YAAI,WAAU;;8BAKb,2TAAC;oBAAI,WAAU;8BACb,cAAA,2TAAC,qNAAK;wBACJ,KAAK,cAAc;wBACnB,KAAI;wBACJ,IAAI;wBACJ,WAAU;;;;;;;;;;;8BAId,2TAAC;oBAAI,WAAU;;sCACb,2TAAC;4BAAE,WAAU;sCAAoB;;;;;;sCACjC,2TAAC;4BAAG,WAAU;sCAAiC;;;;;;;;;;;;8BAGjD,2TAAC;oBACC,WAAU;oBACV,SAAS;wBACP,OAAO,IAAI,CAAC;wBACZ,SAAS,IAAA,sOAAS,EAAC;oBACrB;8BAEA,cAAA,2TAAC;wBAAK,WAAU;;4BACb;4BAAc;;;;;;;;;;;;;;;;;;;;;;;AAM3B;uCAEe","debugId":null}},
    {"offset": {"line": 2183, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Renz-Lunci/Desktop/Rx/%20Technology/Repository/lakaw-socmed-Website/src/app/home/Comment/CommentItem.tsx"],"sourcesContent":["\"use client\";\r\nimport Image from \"next/image\";\r\nimport React, { useState } from \"react\";\r\nimport { Record } from \"@/app/types/CommentRes\";\r\nimport { useAppDispatch, useAppSelector } from \"@/app/utils/hooks\";\r\nimport { useReplies } from \"@/app/store/api/getCommentReply\";\r\nimport { setReplyingTo } from \"@/app/store/Slice/storeCommentsReplies\";\r\nimport useApiPost from \"@/app/hooks/postData\";\r\nimport { LikeUnlikeResponse } from \"@/app/types/ResTypes\";\r\nimport { toast } from \"react-toastify\";\r\nimport { formatTimeAgo } from \"@/app/components/formatDates/formatTimeAgo\";\r\n\r\ninterface Props {\r\n  record: Record;\r\n}\r\n\r\nexport default function CommentItem({ record }: Props) {\r\n  const [showReplies, setShowReplies] = useState(false);\r\n  const [likeCount, setLikeCount] = useState(record?.like_count || 0);\r\n  const [isLiked, setIsLiked] = useState(record?.isLiked === 1);\r\n  const [subcommentLikeCount, setSubcommentLikeCount] = useState(\r\n    record?.like_count || 0\r\n  );\r\n  const [isSubcommentLiked, setIsSubcommentLiked] = useState(\r\n    record?.isLiked === 1\r\n  );\r\n  const dispatch = useAppDispatch();\r\n  const replies = useAppSelector((state) => state.comments.replies || []);\r\n  const { postData } = useApiPost();\r\n\r\n  const { isLoading } = useReplies(record?.comment_id, showReplies);\r\n\r\n  const handleViewReplies = () => {\r\n    setShowReplies((prev) => !prev);\r\n  };\r\n\r\n  // all field data for like\r\n  const socialId = useAppSelector((state) => state.comment.activeCommentPostId);\r\n  const userId = useAppSelector((state) => state.comment.activeReelUserId);\r\n\r\n  // like main comment ====================================\r\n  const handleLikeComment = async (commentId: number) => {\r\n    // Optimistic UI update\r\n    setIsLiked((prev) => !prev);\r\n    setLikeCount((prev) => (isLiked ? prev - 1 : prev + 1));\r\n\r\n    try {\r\n      const response: LikeUnlikeResponse = await postData(\"/like/like-unlike\", {\r\n        social_id: socialId,\r\n        social_type: \"reel\",\r\n        user_id: userId,\r\n        comment_id: commentId,\r\n      });\r\n      if (response?.status) {\r\n        toast.success(response?.message);\r\n      } else {\r\n        toast.error(response?.message);\r\n        // Revert changes if failed\r\n        setIsLiked((prev) => !prev);\r\n        setLikeCount((prev) => (isLiked ? prev + 1 : prev - 1));\r\n      }\r\n    } catch (error) {\r\n      // Revert on error\r\n      setIsLiked((prev) => !prev);\r\n      setLikeCount((prev) => (isLiked ? prev + 1 : prev - 1));\r\n    }\r\n  };\r\n\r\n  // like subcomment ======================\r\n  const handleLikeSubcomment = async (commentId: number) => {\r\n    // Optimistic UI update\r\n    setIsSubcommentLiked((prev) => !prev);\r\n    setSubcommentLikeCount((prev) => (isSubcommentLiked ? prev - 1 : prev + 1));\r\n\r\n    try {\r\n      const response: LikeUnlikeResponse = await postData(\"/like/like-unlike\", {\r\n        social_id: socialId,\r\n        social_type: \"reel\",\r\n        user_id: userId,\r\n        comment_id: commentId,\r\n      });\r\n      if (response?.status) {\r\n        toast.success(response?.message);\r\n      } else {\r\n        toast.error(response?.message);\r\n        // Revert changes if failed\r\n        setIsSubcommentLiked((prev) => !prev);\r\n        setSubcommentLikeCount((prev) => (isLiked ? prev + 1 : prev - 1));\r\n      }\r\n    } catch (error) {\r\n      // Revert on error\r\n      setIsLiked((prev) => !prev);\r\n      setLikeCount((prev) => (isLiked ? prev + 1 : prev - 1));\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-2 pr-4\">\r\n      {/* Main Comment */}\r\n      <div className=\"flex items-start gap-3\">\r\n        <div className=\"rounded-full w-8 h-8\">\r\n          <Image\r\n            src={record?.commenter?.profile_pic}\r\n            className=\"w-full h-full object-cover rounded-full\"\r\n            alt=\"profile\"\r\n            width={40}\r\n            height={40}\r\n          />\r\n        </div>\r\n\r\n        <div className=\"flex-1\">\r\n          <div className=\"text-[12px] font-medium text-dark\">\r\n            {record?.commenter?.user_name}\r\n          </div>\r\n          <div className=\"flex justify-between\">\r\n            <div className=\"text-[12px] text-[#656565]\">{record?.comment}</div>\r\n            {/* <PiHeart\r\n              className={`cursor-pointer ${\r\n                record?.isLiked === 1 ? \"text-red\" : \"text-gray\"\r\n              }`}\r\n              onClick={() => handleLikeComment(record?.comment_id)}\r\n            /> */}\r\n            {/* <Image src={record?.isLiked === 1 ? \"/home/filled_heart.png\" : \"/home/like.png\"} className=\"cursor-pointer\" height={20} width={20} onClick={() => handleLikeComment(record?.comment_id)} alt=\"like\" /> */}\r\n\r\n            <Image\r\n              src={isLiked ? \"/home/filled_heart.png\" : \"/home/like.png\"}\r\n              className=\"cursor-pointer transition duration-150 ease-in-out h-fit\"\r\n              height={18}\r\n              width={18}\r\n              onClick={() => handleLikeComment(record?.comment_id)}\r\n              alt=\"like\"\r\n            />\r\n          </div>\r\n          <div className=\"text-[10px] text-gray-500 flex gap-4 mt-1\">\r\n            <span>{formatTimeAgo(record?.createdAt)}</span>\r\n            <span className=\"cursor-pointer hover:underline\">\r\n              {likeCount} like\r\n            </span>\r\n\r\n            <span\r\n              className=\"cursor-pointer hover:underline\"\r\n              onClick={() =>\r\n                dispatch(\r\n                  setReplyingTo({\r\n                    commentId: record?.comment_id,\r\n                    userName: record?.commenter?.user_name || \"user\",\r\n                  })\r\n                )\r\n              }\r\n            >\r\n              Reply\r\n            </span>\r\n          </div>\r\n\r\n          {record?.reply_count > 0 && (\r\n            <div\r\n              className=\"text-xs text-gray font-medium cursor-pointer mt-1\"\r\n              onClick={handleViewReplies}\r\n            >\r\n              <div className=\"flex gap-2 text-[10px] py-1 place-items-center\">\r\n                <hr className=\"w-10\" />\r\n                {showReplies\r\n                  ? \"Hide replies\"\r\n                  : `View replies (${record?.reply_count})`}\r\n                <hr className=\"w-10\" />\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Replies (only shown under this comment) */}\r\n\r\n      {showReplies && (\r\n        <div className=\"ml-10 space-y-2\">\r\n          {isLoading && (\r\n            <div className=\"text-xs text-gray-400\">Loading replies...</div>\r\n          )}\r\n          {replies?.map((reply) => (\r\n            <div key={reply?.comment_id} className=\"flex items-start gap-3\">\r\n              <div className=\"rounded-full w-8 h-8\">\r\n                <Image\r\n                  src={reply?.commenter?.profile_pic}\r\n                  className=\"w-full h-full object-cover\"\r\n                  alt=\"profile\"\r\n                  width={30}\r\n                  height={30}\r\n                />\r\n              </div>\r\n              <div className=\"flex-1\">\r\n                <div className=\"text-[12px] font-medium text-dark\">\r\n                  {reply?.commenter?.first_name}\r\n                </div>\r\n                <div className=\"flex justify-between\">\r\n                  <div className=\"text-[12px] text-dark-gray\">\r\n                    {reply?.comment}\r\n                  </div>\r\n                  <Image\r\n                    src={\r\n                      isSubcommentLiked\r\n                        ? \"/home/filled_heart.png\"\r\n                        : \"/home/like.png\"\r\n                    }\r\n                    className=\"cursor-pointer transition duration-150 ease-in-out h-fit\"\r\n                    height={18}\r\n                    width={18}\r\n                    onClick={() => handleLikeSubcomment(record?.comment_id)}\r\n                    alt=\"like\"\r\n                  />\r\n                </div>\r\n                <div className=\"text-[10px] text-gray-500 flex gap-4 mt-1\">\r\n                  <span>{formatTimeAgo(reply?.createdAt)}</span>\r\n                  <span className=\"cursor-pointer hover:underline\">\r\n                    {subcommentLikeCount} like\r\n                  </span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2549, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Renz-Lunci/Desktop/Rx/%20Technology/Repository/lakaw-socmed-Website/src/app/home/Comment/EmojiPickerButton.tsx"],"sourcesContent":["// EmojiPickerButton.tsx\r\n\"use client\";\r\n\r\nimport React, { useState, useRef, useEffect } from \"react\";\r\nimport EmojiPicker from \"emoji-picker-react\";\r\nimport Image from \"next/image\";\r\n\r\ninterface EmojiPickerButtonProps {\r\n  onSelect: (emoji: string) => void;\r\n}\r\n\r\nconst EmojiPickerButton: React.FC<EmojiPickerButtonProps> = ({ onSelect }) => {\r\n  const [showPicker, setShowPicker] = useState(false);\r\n  const pickerRef = useRef<HTMLDivElement>(null);\r\n\r\n  // Close picker on outside click\r\n  useEffect(() => {\r\n    const handleClickOutside = (event: MouseEvent) => {\r\n      if (\r\n        pickerRef.current &&\r\n        !pickerRef.current.contains(event.target as Node)\r\n      ) {\r\n        setShowPicker(false);\r\n      }\r\n    };\r\n\r\n    document.addEventListener(\"mousedown\", handleClickOutside);\r\n    return () => document.removeEventListener(\"mousedown\", handleClickOutside);\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"relative pt-2\">\r\n      <button\r\n        type=\"button\"\r\n        onClick={() => setShowPicker((prev) => !prev)}\r\n        className=\"text-xl\"\r\n      >\r\n        <Image src=\"/home/smile.png\" alt=\"smile\" width={20} height={20}/>\r\n      </button>\r\n\r\n      {showPicker && (\r\n        <div ref={pickerRef} className=\"absolute bottom-10 right-0 z-50\">\r\n          <EmojiPicker\r\n            onEmojiClick={(emojiData) => {\r\n              onSelect(emojiData.emoji);\r\n              setShowPicker(false);\r\n            }}\r\n            height={350}\r\n            width={300}\r\n          />\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default EmojiPickerButton;\r\n"],"names":[],"mappings":"AAAA,wBAAwB;;;;;;AAGxB;AACA;AACA;AAJA;;;;;AAUA,MAAM,oBAAsD,CAAC,EAAE,QAAQ,EAAE;IACvE,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,8RAAQ,EAAC;IAC7C,MAAM,YAAY,IAAA,4RAAM,EAAiB;IAEzC,gCAAgC;IAChC,IAAA,+RAAS,EAAC;QACR,MAAM,qBAAqB,CAAC;YAC1B,IACE,UAAU,OAAO,IACjB,CAAC,UAAU,OAAO,CAAC,QAAQ,CAAC,MAAM,MAAM,GACxC;gBACA,cAAc;YAChB;QACF;QAEA,SAAS,gBAAgB,CAAC,aAAa;QACvC,OAAO,IAAM,SAAS,mBAAmB,CAAC,aAAa;IACzD,GAAG,EAAE;IAEL,qBACE,2TAAC;QAAI,WAAU;;0BACb,2TAAC;gBACC,MAAK;gBACL,SAAS,IAAM,cAAc,CAAC,OAAS,CAAC;gBACxC,WAAU;0BAEV,cAAA,2TAAC,qNAAK;oBAAC,KAAI;oBAAkB,KAAI;oBAAQ,OAAO;oBAAI,QAAQ;;;;;;;;;;;YAG7D,4BACC,2TAAC;gBAAI,KAAK;gBAAW,WAAU;0BAC7B,cAAA,2TAAC,2QAAW;oBACV,cAAc,CAAC;wBACb,SAAS,UAAU,KAAK;wBACxB,cAAc;oBAChB;oBACA,QAAQ;oBACR,OAAO;;;;;;;;;;;;;;;;;AAMnB;uCAEe","debugId":null}},
    {"offset": {"line": 2630, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Renz-Lunci/Desktop/Rx/%20Technology/Repository/lakaw-socmed-Website/src/app/home/Comment/InputBox.tsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport useApiPost from \"@/app/hooks/postData\";\r\nimport { useAppDispatch, useAppSelector } from \"@/app/utils/hooks\";\r\nimport { clearReplyingTo } from \"@/app/store/Slice/storeCommentsReplies\";\r\nimport { setCommentAddedTrue } from \"@/app/store/Slice/handleCommentCount\";\r\nimport EmojiPickerButton from \"./EmojiPickerButton\"; // ðŸ‘ˆ import your new component\r\n\r\ninterface InputBoxProps {\r\n  onCommentAdded: () => void;\r\n}\r\n\r\nexport default function InputBox({ onCommentAdded }: InputBoxProps) {\r\n  const dispatch = useAppDispatch();\r\n  const { postData } = useApiPost();\r\n  const [text, setText] = useState(\"\");\r\n\r\n  const activeSocialUserId = useAppSelector(\r\n    (state) => state.comment.activeReelUserId\r\n  );\r\n  const activeSocialId = useAppSelector(\r\n    (state) => state.comment.activeCommentPostId\r\n  );\r\n  const replyingTo = useAppSelector((state) => state.comments.replyingTo);\r\n\r\n  useEffect(() => {\r\n    if (replyingTo) {\r\n      setText(`@${replyingTo.userName} `);\r\n    }\r\n  }, [replyingTo]);\r\n\r\n  const onSubmit = async () => {\r\n    const trimmed = text.trim();\r\n    if (!trimmed) return;\r\n\r\n    let commentToSend = trimmed;\r\n    if (replyingTo && trimmed.startsWith(`@${replyingTo.userName}`)) {\r\n      commentToSend = trimmed.replace(`@${replyingTo.userName}`, \"\").trim();\r\n    }\r\n\r\n    const payload = {\r\n      social_id: activeSocialId,\r\n      comment: commentToSend,\r\n      user_id: activeSocialUserId,\r\n      social_type: \"reel\",\r\n      comment_owner_id: activeSocialUserId,\r\n      ...(replyingTo ? { comment_ref_id: replyingTo.commentId } : {}),\r\n    };\r\n\r\n    try {\r\n      await postData(\"/comment/add-comment\", payload);\r\n      onCommentAdded();\r\n      setText(\"\");\r\n      dispatch(clearReplyingTo());\r\n      dispatch(setCommentAddedTrue());\r\n    } catch (error) {\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"p-2 flex gap-2 place-items-center relative\">\r\n      <textarea\r\n        value={text}\r\n        onChange={(e) => setText(e.target.value)}\r\n        placeholder=\"Write a comment...\"\r\n        className=\"w-full px-3 py-1.5 rounded bg-white text-xs text-dark focus:outline-none resize-none min-h-[24px] max-h-[60px] overflow-y-auto\"\r\n        onKeyDown={(e) => {\r\n          if (e.key === \"Enter\" && !e.shiftKey && text.trim()) {\r\n            e.preventDefault();\r\n            onSubmit();\r\n          }\r\n        }}\r\n      />\r\n\r\n      <EmojiPickerButton\r\n        onSelect={(emoji: string) => setText((prev) => prev + emoji)}\r\n      />\r\n\r\n      <button\r\n        onClick={onSubmit}\r\n        className=\"bg-main-green py-1 px-2 rounded-xl text-sm text-primary font-medium\"\r\n      >\r\n        Send\r\n      </button>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;AACA;AACA,sYAAqD,+BAA+B;;;;;;;;AAMrE,SAAS,SAAS,EAAE,cAAc,EAAiB;IAChE,MAAM,WAAW,IAAA,4NAAc;IAC/B,MAAM,EAAE,QAAQ,EAAE,GAAG,IAAA,wNAAU;IAC/B,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,8RAAQ,EAAC;IAEjC,MAAM,qBAAqB,IAAA,4NAAc,EACvC,CAAC,QAAU,MAAM,OAAO,CAAC,gBAAgB;IAE3C,MAAM,iBAAiB,IAAA,4NAAc,EACnC,CAAC,QAAU,MAAM,OAAO,CAAC,mBAAmB;IAE9C,MAAM,aAAa,IAAA,4NAAc,EAAC,CAAC,QAAU,MAAM,QAAQ,CAAC,UAAU;IAEtE,IAAA,+RAAS,EAAC;QACR,IAAI,YAAY;YACd,QAAQ,CAAC,CAAC,EAAE,WAAW,QAAQ,CAAC,CAAC,CAAC;QACpC;IACF,GAAG;QAAC;KAAW;IAEf,MAAM,WAAW;QACf,MAAM,UAAU,KAAK,IAAI;QACzB,IAAI,CAAC,SAAS;QAEd,IAAI,gBAAgB;QACpB,IAAI,cAAc,QAAQ,UAAU,CAAC,CAAC,CAAC,EAAE,WAAW,QAAQ,EAAE,GAAG;YAC/D,gBAAgB,QAAQ,OAAO,CAAC,CAAC,CAAC,EAAE,WAAW,QAAQ,EAAE,EAAE,IAAI,IAAI;QACrE;QAEA,MAAM,UAAU;YACd,WAAW;YACX,SAAS;YACT,SAAS;YACT,aAAa;YACb,kBAAkB;YAClB,GAAI,aAAa;gBAAE,gBAAgB,WAAW,SAAS;YAAC,IAAI,CAAC,CAAC;QAChE;QAEA,IAAI;YACF,MAAM,SAAS,wBAAwB;YACvC;YACA,QAAQ;YACR,SAAS,IAAA,qPAAe;YACxB,SAAS,IAAA,uPAAmB;QAC9B,EAAE,OAAO,OAAO,CAChB;IACF;IAEA,qBACE,2TAAC;QAAI,WAAU;;0BACb,2TAAC;gBACC,OAAO;gBACP,UAAU,CAAC,IAAM,QAAQ,EAAE,MAAM,CAAC,KAAK;gBACvC,aAAY;gBACZ,WAAU;gBACV,WAAW,CAAC;oBACV,IAAI,EAAE,GAAG,KAAK,WAAW,CAAC,EAAE,QAAQ,IAAI,KAAK,IAAI,IAAI;wBACnD,EAAE,cAAc;wBAChB;oBACF;gBACF;;;;;;0BAGF,2TAAC,2OAAiB;gBAChB,UAAU,CAAC,QAAkB,QAAQ,CAAC,OAAS,OAAO;;;;;;0BAGxD,2TAAC;gBACC,SAAS;gBACT,WAAU;0BACX;;;;;;;;;;;;AAKP","debugId":null}},
    {"offset": {"line": 2733, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Renz-Lunci/Desktop/Rx/%20Technology/Repository/lakaw-socmed-Website/src/app/home/Comment/CommentBox.tsx"],"sourcesContent":["import React, { useEffect, useRef } from \"react\";\r\nimport CommentItem from \"./CommentItem\";\r\nimport InputBox from \"./InputBox\";\r\nimport { useAppSelector, useAppDispatch } from \"@/app/utils/hooks\";\r\nimport { useCommentList } from \"@/app/store/api/getCommentList\";\r\nimport Image from \"next/image\";\r\nimport {\r\n  nextPage,\r\n  setCurrentPage,\r\n  setRefId,\r\n  setSocialId,\r\n} from \"@/app/store/Slice/commentSlice\";\r\nimport { setMainComments } from \"@/app/store/Slice/storeCommentsReplies\";\r\nimport { useQueryClient } from \"@tanstack/react-query\";\r\n\r\nexport default function CommentBox() {\r\n  const dispatch = useAppDispatch();\r\n  const { currentPage, commentRefId } = useAppSelector((s) => s.getComment);\r\n  const activeCommentPostId = useAppSelector(\r\n    (state) => state.comment.activeCommentPostId\r\n  );\r\n  const allComments = useAppSelector((state) => state.comments.mainComments);\r\n\r\n  const { data, isFetching } = useCommentList(\r\n    activeCommentPostId ?? 0,\r\n    currentPage,\r\n    commentRefId\r\n  );\r\n\r\n  useEffect(() => {\r\n    dispatch(setSocialId(activeCommentPostId ?? 0));\r\n    dispatch(setRefId(0));\r\n    dispatch(setCurrentPage(1));\r\n  }, [activeCommentPostId, dispatch]);\r\n\r\n  useEffect(() => {\r\n    if (!data) return;\r\n\r\n    if (currentPage === 1) {\r\n      dispatch(setMainComments(data.comments));\r\n    } else {\r\n      const existingIds = new Set(allComments.map((c) => c.comment_id));\r\n      const newUnique = data.comments.filter(\r\n        (c) => !existingIds.has(c.comment_id)\r\n      );\r\n      if (newUnique.length > 0) {\r\n        dispatch(setMainComments([...allComments, ...newUnique]));\r\n      }\r\n    }\r\n  }, [data, currentPage, allComments, dispatch]);\r\n\r\n  const scrollRef = useRef<HTMLDivElement>(null);\r\n\r\n  const onScroll = () => {\r\n    const el = scrollRef.current;\r\n    if (!el || isFetching) return;\r\n\r\n    const { scrollHeight, scrollTop, clientHeight } = el;\r\n\r\n    if (scrollHeight - scrollTop <= clientHeight + 30) {\r\n      if (data && currentPage < data.pagination.total_pages) {\r\n        dispatch(nextPage());\r\n      }\r\n    }\r\n  };\r\n  const queryClient = useQueryClient();\r\n\r\n  const handleCommentAdded = () => {\r\n    dispatch(setCurrentPage(1));\r\n\r\n    queryClient.refetchQueries({\r\n      queryKey: [\r\n        \"comments\",\r\n        activeCommentPostId,\r\n        1,\r\n        commentRefId && commentRefId > 0 ? commentRefId : \"no-ref\",\r\n      ],\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex flex-col h-full\">\r\n      {/* Scrollable comment area */}\r\n      <div\r\n        ref={scrollRef}\r\n        onScroll={onScroll}\r\n        className=\"flex-1 overflow-y-auto py-3 pr-1 space-y-4 px-6\"\r\n      >\r\n        {allComments.length === 0 && !isFetching && (\r\n          <div className=\" flex flex-col gap-1 place-items-center justify-center min-h-80\">\r\n            <Image src=\"/home/NoComment.png\" alt=\"empty\" width={70} height={70} />\r\n            <p className=\"text-center text-sm text-gray\">No comments yet.</p>\r\n          </div>\r\n        )}\r\n\r\n        {allComments\r\n          .slice()\r\n          .sort(\r\n            (a, b) =>\r\n              new Date(a.createdAt).getTime() - new Date(b.createdAt).getTime()\r\n          )\r\n          .map((record) => (\r\n            <CommentItem key={record.comment_id} record={record} />\r\n          ))}\r\n\r\n        {isFetching && (\r\n          <div className=\"text-center text-gray-400 text-sm\">Loading...</div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Input box pinned at bottom */}\r\n      <div className=\"border-t border-[#F0F0F0] pt-2 bg-primary\">\r\n        <InputBox onCommentAdded={handleCommentAdded} />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAMA;AACA;;;;;;;;;;;AAEe,SAAS;IACtB,MAAM,WAAW,IAAA,4NAAc;IAC/B,MAAM,EAAE,WAAW,EAAE,YAAY,EAAE,GAAG,IAAA,4NAAc,EAAC,CAAC,IAAM,EAAE,UAAU;IACxE,MAAM,sBAAsB,IAAA,4NAAc,EACxC,CAAC,QAAU,MAAM,OAAO,CAAC,mBAAmB;IAE9C,MAAM,cAAc,IAAA,4NAAc,EAAC,CAAC,QAAU,MAAM,QAAQ,CAAC,YAAY;IAEzE,MAAM,EAAE,IAAI,EAAE,UAAU,EAAE,GAAG,IAAA,4OAAc,EACzC,uBAAuB,GACvB,aACA;IAGF,IAAA,+RAAS,EAAC;QACR,SAAS,IAAA,yOAAW,EAAC,uBAAuB;QAC5C,SAAS,IAAA,sOAAQ,EAAC;QAClB,SAAS,IAAA,4OAAc,EAAC;IAC1B,GAAG;QAAC;QAAqB;KAAS;IAElC,IAAA,+RAAS,EAAC;QACR,IAAI,CAAC,MAAM;QAEX,IAAI,gBAAgB,GAAG;YACrB,SAAS,IAAA,qPAAe,EAAC,KAAK,QAAQ;QACxC,OAAO;YACL,MAAM,cAAc,IAAI,IAAI,YAAY,GAAG,CAAC,CAAC,IAAM,EAAE,UAAU;YAC/D,MAAM,YAAY,KAAK,QAAQ,CAAC,MAAM,CACpC,CAAC,IAAM,CAAC,YAAY,GAAG,CAAC,EAAE,UAAU;YAEtC,IAAI,UAAU,MAAM,GAAG,GAAG;gBACxB,SAAS,IAAA,qPAAe,EAAC;uBAAI;uBAAgB;iBAAU;YACzD;QACF;IACF,GAAG;QAAC;QAAM;QAAa;QAAa;KAAS;IAE7C,MAAM,YAAY,IAAA,4RAAM,EAAiB;IAEzC,MAAM,WAAW;QACf,MAAM,KAAK,UAAU,OAAO;QAC5B,IAAI,CAAC,MAAM,YAAY;QAEvB,MAAM,EAAE,YAAY,EAAE,SAAS,EAAE,YAAY,EAAE,GAAG;QAElD,IAAI,eAAe,aAAa,eAAe,IAAI;YACjD,IAAI,QAAQ,cAAc,KAAK,UAAU,CAAC,WAAW,EAAE;gBACrD,SAAS,IAAA,sOAAQ;YACnB;QACF;IACF;IACA,MAAM,cAAc,IAAA,qRAAc;IAElC,MAAM,qBAAqB;QACzB,SAAS,IAAA,4OAAc,EAAC;QAExB,YAAY,cAAc,CAAC;YACzB,UAAU;gBACR;gBACA;gBACA;gBACA,gBAAgB,eAAe,IAAI,eAAe;aACnD;QACH;IACF;IAEA,qBACE,2TAAC;QAAI,WAAU;;0BAEb,2TAAC;gBACC,KAAK;gBACL,UAAU;gBACV,WAAU;;oBAET,YAAY,MAAM,KAAK,KAAK,CAAC,4BAC5B,2TAAC;wBAAI,WAAU;;0CACb,2TAAC,qNAAK;gCAAC,KAAI;gCAAsB,KAAI;gCAAQ,OAAO;gCAAI,QAAQ;;;;;;0CAChE,2TAAC;gCAAE,WAAU;0CAAgC;;;;;;;;;;;;oBAIhD,YACE,KAAK,GACL,IAAI,CACH,CAAC,GAAG,IACF,IAAI,KAAK,EAAE,SAAS,EAAE,OAAO,KAAK,IAAI,KAAK,EAAE,SAAS,EAAE,OAAO,IAElE,GAAG,CAAC,CAAC,uBACJ,2TAAC,qOAAW;4BAAyB,QAAQ;2BAA3B,OAAO,UAAU;;;;;oBAGtC,4BACC,2TAAC;wBAAI,WAAU;kCAAoC;;;;;;;;;;;;0BAKvD,2TAAC;gBAAI,WAAU;0BACb,cAAA,2TAAC,kOAAQ;oBAAC,gBAAgB;;;;;;;;;;;;;;;;;AAIlC","debugId":null}}]
}